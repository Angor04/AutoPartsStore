# Nixpacks configuration for Astro + Node.js
# Auto-detected by Coolify

[build]
# Build the project with npm timeouts and offline preferences
cmds = [
  "npm install --legacy-peer-deps --prefer-offline --no-audit --fetch-timeout=300000 --fetch-retry-mintimeout=20000",
  "npm run build"
]

[start]
# Start the production server
cmd = "node dist/server/entry.mjs"

[variables]
# Node.js version
NODE_ENV = "production"
PORT = "4321"
NPM_CONFIG_FETCH_TIMEOUT = "300000"
NPM_CONFIG_FETCH_RETRY_MINTIMEOUT = "20000"
