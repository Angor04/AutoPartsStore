---
// src/components/ui/AccountSidebar.astro
interface Props {
  active: 'perfil' | 'pedidos' | 'direcciones';
}

const { active } = Astro.props;
---

<div class="bg-white rounded-lg shadow-sm p-6">
  <h2 class="text-lg font-serif font-bold text-charcoal-900 mb-6">Mi Cuenta</h2>
  <nav class="space-y-4">
    <a 
      href="/mi-cuenta/perfil" 
      class={`block text-sm transition-colors ${
        active === 'perfil' 
          ? 'text-red-600 font-medium border-l-2 border-red-600 pl-3' 
          : 'text-charcoal-600 hover:text-red-600 pl-3'
      }`}
    >
      Perfil
    </a>
    <a 
      href="/mi-cuenta/pedidos" 
      class={`block text-sm transition-colors ${
        active === 'pedidos' 
          ? 'text-red-600 font-medium border-l-2 border-red-600 pl-3' 
          : 'text-charcoal-600 hover:text-red-600 pl-3'
      }`}
    >
      Mis Pedidos
    </a>
    <a 
      href="/mi-cuenta/direcciones" 
      class={`block text-sm transition-colors ${
        active === 'direcciones' 
          ? 'text-red-600 font-medium border-l-2 border-red-600 pl-3' 
          : 'text-charcoal-600 hover:text-red-600 pl-3'
      }`}
    >
      Mis Direcciones
    </a>
    <button 
      id="logout-btn-sidebar" 
      class="block w-full text-left text-red-600 hover:text-red-800 transition-colors text-sm pl-3 font-medium"
    >
      Cerrar Sesi√≥n
    </button>
  </nav>
</div>

<script>
  import { clearCartOnLogout } from '@/stores/cart';

  // Logout Sidebar
  document.getElementById('logout-btn-sidebar')?.addEventListener('click', async () => {
    try {
      await fetch('/api/auth/logout', { method: 'POST' });
      await clearCartOnLogout();
    } catch (error) {
      console.error('Error during logout:', error);
    }
    window.location.href = '/';
  });
</script>
