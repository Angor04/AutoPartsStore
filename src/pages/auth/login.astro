---
// src/pages/auth/login.astro
// Página de login para usuarios

import BaseLayout from "@/layouts/BaseLayout.astro";

export const prerender = false;

const message = Astro.url.searchParams.get('message');
const error = Astro.url.searchParams.get('error');
---

<BaseLayout title="Iniciar Sesión" description="Acceso a tu cuenta">
  <style>
    .login-wrapper {
      height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      background-color: #f9f9f9;
      padding: 20px;
      overflow-x: hidden;
      overflow-y: auto;
    }

    .login-card {
      background: white;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      width: 100%;
      max-width: 380px;
      padding: 35px;
    }

    .logo-section {
      text-align: center;
      margin-bottom: 18px;
    }

    .logo {
      width: 110px;
      height: 110px;
      margin: 0 auto 12px;
    }

    .login-header {
      text-align: center;
      margin-bottom: 22px;
    }

    .login-header h1 {
      font-size: 26px;
      font-weight: bold;
      color: #1a1a1a;
      margin-bottom: 5px;
    }

    .login-header p {
      font-size: 13px;
      color: #666;
    }

    .form-group {
      margin-bottom: 17px;
    }

    label {
      display: block;
      font-weight: 600;
      color: #333;
      margin-bottom: 6px;
      font-size: 13px;
    }

    input {
      width: 100%;
      padding: 11px 12px;
      border: 1px solid #ddd;
      border-radius: 6px;
      font-size: 14px;
      transition: all 0.2s ease;
      font-family: inherit;
    }

    input:focus {
      outline: none;
      border-color: #dc2626;
      box-shadow: 0 0 0 3px rgba(220, 38, 38, 0.1);
    }

    .submit-btn {
      width: 100%;
      padding: 12px;
      background-color: #dc2626;
      color: white;
      border: none;
      border-radius: 6px;
      font-weight: 600;
      font-size: 15px;
      cursor: pointer;
      transition: all 0.2s ease;
      margin-top: 7px;
      margin-bottom: 13px;
    }

    .submit-btn:hover {
      background-color: #991b1b;
    }

    .error {
      background: #fee2e2;
      color: #991b1b;
      padding: 12px 14px;
      border-radius: 6px;
      margin-bottom: 20px;
      font-size: 14px;
      border: 1px solid #fecaca;
    }

    .success {
      background: #dcfce7;
      color: #166534;
      padding: 12px 14px;
      border-radius: 6px;
      margin-bottom: 20px;
      font-size: 14px;
      border: 1px solid #bbf7d0;
    }

    .footer-links {
      text-align: center;
      font-size: 12px;
      color: #666;
      margin-top: 12px;
      padding-top: 0px;
    }

    .footer-links p {
      margin: 0 0 12px 0;
    }

    .footer-link {
      color: #dc2626;
      text-decoration: none;
      font-weight: 600;
    }

    .footer-link:hover {
      text-decoration: underline;
    }

    .guest-link {
      display: inline-block;
      padding: 10px 0;
      color: #dc2626;
      text-decoration: none;
      font-weight: 600;
      font-size: 13px;
    }

    .guest-link:hover {
      text-decoration: underline;
    }

    .password-link {
      display: inline-block;
      color: #dc2626;
      text-decoration: none;
      font-weight: 600;
      font-size: 13px;
    }

    .password-link:hover {
      text-decoration: underline;
    }

    .guest-btn {
      width: 100%;
      padding: 12px;
      background-color: #9ca3af;
      color: white;
      border: none;
      border-radius: 6px;
      font-weight: 600;
      font-size: 15px;
      cursor: pointer;
      transition: all 0.2s ease;
      margin-bottom: 13px;
      text-decoration: none;
      display: block;
      text-align: center;
    }

    .guest-btn:hover {
      background-color: #6b7280;
    }

    .divider-or {
      display: flex;
      align-items: center;
      margin: 13px 0;
      gap: 12px;
    }

    .divider-or::before,
    .divider-or::after {
      content: '';
      flex: 1;
      height: 1px;
      background-color: #eee;
    }

    .divider-or span {
      color: #666;
      font-size: 12px;
      font-weight: 500;
    }
  </style>

  <div class="login-wrapper">
    <div class="login-card">
      <!-- Logo -->
      <div class="logo-section">
        <img 
          src="https://res.cloudinary.com/ddi0g76bk/image/upload/v1768210429/logo_btu63x.webp" 
          alt="AutoPartsStore" 
          class="logo"
          style="width: 110px; height: 110px; object-fit: contain;"
        />
      </div>

      <div class="login-header">
        <h1>AutoPartsStore</h1>
        <p>Inicia sesión en tu cuenta</p>
      </div>

      {error && <div class="error">{error}</div>}
      {message && <div class="success">{message}</div>}

      <form method="POST" action="/api/auth/login">
        <div class="form-group">
          <label for="email">Correo Electrónico</label>
          <input
            type="email"
            id="email"
            name="email"
            placeholder="tu@email.com"
            autocomplete="email"
            required
          />
        </div>

        <div class="form-group">
          <label for="password">Contraseña</label>
          <input
            type="password"
            id="password"
            name="password"
            placeholder="••••••••"
            autocomplete="current-password"
            required
          />
          <a href="/auth/register" class="password-link" style="display: block; margin-top: 8px; text-align: right;">¿No tienes cuenta? Regístrate</a>
        </div>

        <button type="submit" class="submit-btn">Iniciar Sesión</button>
      </form>

      <div class="divider-or">
        <span>o</span>
      </div>

      <!-- Guest Login -->
      <a href="/" class="guest-btn">Continuar como invitado</a>

      <!-- Footer Links -->
      <div class="footer-links">
        <p>
          <a href="/auth/recuperar-contrasena" class="password-link">¿Olvidaste tu contraseña?</a>
        </p>
      </div>
    </div>
  </div>
</BaseLayout>
